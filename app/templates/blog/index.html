{% extends "base.html" %}
{% block title %}Home | Bloxy{% endblock %}

{% block content %}
<section class="galaxy-hero mb-4">
  <p class="small text-uppercase mb-2">Universe Feed</p>
  <h1 class="h3 mb-2">Bloxy</h1>
  <p class="mb-0 text-muted">Share posts across a cosmic-themed blogging universe.</p>
</section>

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3 mb-0">Latest Posts</h1>
  {% if current_user.is_authenticated and current_user.can_write_posts %}
    <a class="btn btn-primary" href="{{ url_for('blog.post_create') }}">Write Post</a>
  {% endif %}
</div>

{% if posts %}
  <div class="row g-3">
    {% for post in posts %}
      <div class="col-12">
        <article class="card shadow-sm h-100">
          <div class="card-body">
            <h2 class="h5 card-title mb-1">
              <a class="text-decoration-none" href="{{ url_for('blog.post_detail', post_id=post.id) }}">{{ post.title }}</a>
            </h2>
            <p class="text-muted small mb-3">By {{ post.author.username }} on {{ post.created_at.strftime('%b %d, %Y') }}</p>
            <p class="card-text">{{ post.body[:250] }}{% if post.body|length > 250 %}...{% endif %}</p>
            <p class="text-muted small mb-2">{{ post.likes|length }} likes Â· {{ post.comments|length }} comments</p>
            <a class="btn btn-sm btn-outline-primary" href="{{ url_for('blog.post_detail', post_id=post.id) }}">Read more</a>
          </div>
        </article>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="alert alert-light border text-center py-4">
    No posts yet.
    {% if current_user.is_authenticated and current_user.can_write_posts %}
      Create your first one.
    {% elif current_user.is_authenticated %}
      Wait for an author to publish one, then you can like and comment.
    {% else %}
      Sign in to get started.
    {% endif %}
  </div>
{% endif %}
{% endblock %}
